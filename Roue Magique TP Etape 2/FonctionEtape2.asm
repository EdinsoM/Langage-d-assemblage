;***************************************************************************
	THUMB	
	REQUIRE8
	PRESERVE8

;**************************************************************************
; Fichier Vierge.asm
; Auteur : V.MAHOUT
; Date :  12/11/2013
;**************************************************************************

;***************IMPORT/EXPORT**********************************************


	IMPORT	Barrette1
	IMPORT 	Init_Cible
;**************************************************************************


;***************CONSTANTES*************************************************

	include REG_UTILES.inc 

;**************************************************************************


;***************VARIABLES**************************************************
	 AREA  MesDonnees, data, readwrite
;**************************************************************************



;**************************************************************************



;***************CODE*******************************************************
   	AREA  moncode, code, readonly
;**************************************************************************

		MOV R0,#1
		BL Init_Cible;

DriverGlobal	PROC
	
		PUSH 	{R1,R10}
		LDR		R2, =0X40010810
		MOV		R1, #(0x01<<5)
		STRB 	R1, [R2]
		
		MOV		R1, #1 ;NbLED
Pour
		CMP		R1, #48
		BNE		FairePour
		
FairePour
		LDR		R2,=Barrette1
		LDRB	R3,[R2,R1]
		LSL		R3, R3, #24
			
		MOV		R4, #1 ;NbBit
AutrePour		
		CMP		R4, #12
		BNE		FaireAutrePour

FaireAutrePour
		LDR		R5, =0X40010814
		MOV		R6, #(0x01<<5)
		STRB	R6, [R5]
		
		LDR		R5, =R3
		LDRB	R6, [R5,#8]
		CMP		R6, 0x800000000
		BEQ		SetSin
		B		ResetSin

SetSin	
		LDR		R7, =0X40010810
		MOV		R8, #(0x01<<7)
		STRB	R8,	[R7]

		
		ENDP

;########################################################################
; Procédure ????
;########################################################################
;
; Paramètre entrant  : ???
; Paramètre sortant  : ???
; Variables globales : ???
; Registres modifiés : ???
;------------------------------------------------------------------------






;**************************************************************************
	END